# Spread Heads â€“ TestFlight 1.0.9

Release date: 2025-11-15

## âœ… Review-Focused Changes
- **Login Compliance**: Ensured TestFlight reviewer can sign in with an email (previous rejection was due to supplying only a username). Login flow explicitly requires email for auth; username is supplemental.
- **Consistent Weekly Stats**: Home screen weekly record now matches perâ€‘league standings (no premature singleâ€‘game grading).

## ğŸš€ Enhancements
- **Locked Lines Persistence**: Automatic global sweep on app start + inâ€‘screen backfill guarantees every gameâ€™s locked spread & total are stored per league once lines freeze.
- **Realtime Standings Refresh**: League standings and Home weekly stats autoâ€‘recompute when final results or locked lines change (no manual refresh).
- **Safe Fallback Scoring**: Client scoring only counts games with locked lines, mirroring server scoring logic for accuracy.
- **Scoreboard Fix**: Removed stray state update that caused an undefined setter error; scoreboard no longer throws on finalization recompute.

## ğŸ›  Technical Notes
- Added `globalLockedLinesSweep` to `App.js` to snapshot missing locked lines postâ€‘freeze.
- Added Home screen subscription to `subscribeToFinalResults` + locked_lines signature change detection.
- Refactored Home weekly stats computation into `computeHomeWeeklyStats` for reuse & debouncing.
- Updated versioning: `app.json` (version/buildNumber 1.0.9, android versionCode 9) and `package.json` (1.0.9) for release alignment.

## ğŸ§ª What to Test
1. **Email Login**: Sign out, sign back in using the test account email (not username). Ensure success path and error messaging for invalid email.
2. **Locked Lines**: Open Picks screen after a line freeze and confirm spread/O/U values persist after kickoff & after app restart.
3. **Standings Autoâ€‘Update**: Let a game go final; observe league standings & Home weekly stats update within a second.
4. **Scoreboard Stability**: Navigate Scoreboard during game transitions (pre â†’ in progress â†’ final) and confirm no errors.
5. **Multiple Leagues**: Verify differing locked lines per league are retained and scoring remains leagueâ€‘specific.

## ğŸ“Œ Known / Next
- Server indicator (cached vs client fallback) still not surfaced in UI.
- Historical backfill for preâ€‘1.0.9 weeks is not retroactively applied (intentional scope limit).

## ğŸ“ App Store Review Notes Suggestion
If needed, include in App Review Notes: â€œThe app now enforces email-based authentication for TestFlight review; username is optional profile metadata. Scoring is automatic as games finalizeâ€”no manual interaction required.â€

Let us know if any locked line fails to persist or if the weekly record diverges again.
